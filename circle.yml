machine:
  java:
    version: oraclejdk8

dependencies:
  pre:
    - echo y | android update sdk --no-ui --all --filter "android-25","build-tools-25.0.2","extra-android-m2repository"

test:
  pre:
    # start emulator for instrumentation tests
    - emulator -avd circleci-android21 -no-audio -no-window:
        background: true

    - circle-android wait-for-boot
    - sleep 60
    - adb shell input keyevent 82
    - adb shell setprop dalvik.vm.dexopt-flags v=n,o=v

  override:
   - ./gradlew connectedCheck

deployment:
  coverage:
    branch: [feature/ci]
    commands:
      - bash <(curl -s https://codecov.io/bash)
